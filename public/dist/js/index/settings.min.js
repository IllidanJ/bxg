define(["jquery","template","tools","ckeditor","uploadify","jquery_region"],function(e,a,t){e(function(){e.ajax({type:"get",url:"/api/teacher/profile",success:function(t){if(200==t.code){var i=a("profile",t.result);e(".settings").html(i)}},complete:function(){e("#upfile").uploadify({height:120,swf:"/public/assets/uploadify/uploadify.swf",uploader:"/api/uploader/avatar",width:120,fileObjName:"tc_avatar",buttonText:"",onUploadSuccess:function(a,t,i){e(".preview img").attr("src",JSON.parse(t).result.path);var o=JSON.parse(e.cookie().login_info);o.tc_avatar=JSON.parse(t).result.path,e.cookie("login_info",JSON.stringify(o)),e(".avatar img").attr("src",JSON.parse(t).result.path)}}),t.setDatepicker(e("#joindate")),t.setDatepicker(e("#birthday")),e(".district").region({url:"/public/assets/jquery-region/region.json"}),e("#hometown").val(e("#province")+"|"+e("#city")+"|"+e("#town")),CKEDITOR.replace("ckeditor",{toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},"/",{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"styles"},{name:"colors"}]}),e(".baocun").click(function(){for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();e.ajax({type:"post",url:"/api/teacher/modify",data:e("form").serialize(),success:function(e){200==e.code&&(alert("修改成功"),location.href="/")}})})}})})});